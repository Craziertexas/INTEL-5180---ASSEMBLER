INDP1 EQU P1.0
INDP2 EQU P1.2
B1 EQU P2.0
B2 EQU P2.1
S2 EQU P2.2
S1 EQU P2.3
SENSP EQU P2.4
C1 EQU P1.4
C2 EQU P1.6

ORG 0000H
sjmp INICIO

;INT. ABRIR PUERTAS
ORG 0003H
CALL ABRIRPUERTA1
CALL ABRIRPUERTA2
SETB INDP1
SETB INDP2
OPEN:
SJMP OPEN
RETI

;INT. CERRAR PUERTAS
ORG 0013H
CLR C1
CLR C2
CLR INDP1
CLR INDP2
CLOSE:
SJMP CLOSE
RETI

ORG 0040H
INICIO:
MOV R7, #0000H
MOV IE, #10000101B
MOV IP, #00000001B

CONTINUE:
CLR INDP1
CLR INDP2
SETB C1
SETB C2

ENTRADA:
JNB B1, SALIDA
;PROGRAMA DE ENTRADA
CALL ABRIRPUERTA1
CLR C1
ABRIRP11:
JNB S1, ABRIRP11
SETB C1
CLR INDP1
JNB SENSP, CONTINUE
INC R7
ABRIRP21:
CALL ABRIRPUERTA2
CLR C2
JNB S2, ABRIRP21
SETB C2
CLR INDP2
JB SENSP, ABRIRP21
SJMP CONTINUE

SALIDA:
JNB B2, ENTRADA
;PROGRAMA DE SALIDA
CALL ABRIRPUERTA2
CLR C2
ABRIRP22:
JNB S2, ABRIRP22
SETB C2
CLR INDP2
JNB SENSP, CONTINUE
INC R7
ABRIRP12:
CALL ABRIRPUERTA1
CLR C1
JNB S1, ABRIRP12
SETB C1
CLR INDP1
JB SENSP, ABRIRP12
SJMP CONTINUE


ABRIRPUERTA1:
SETB INDP1
MOV R2, #002H
LOOP11:	
			MOV R1, #010H
LOOP21:	
			DJNZ R1, LOOP21
			DJNZ R2, LOOP11
			RET

ABRIRPUERTA2:
SETB INDP2
MOV R2, #002H
LOOP12:	
			MOV R1, #010H
LOOP22:	
			DJNZ R1, LOOP22
			DJNZ R2, LOOP12
			RET
